syntax = "proto3";

import "google/protobuf/timestamp.proto";

package user;

service UserService {
  rpc CreateUser (CreateUserRequest) returns (CreateUserResponse);
  rpc GetUser (GetUserRequest) returns (GetUserResponse);
  rpc ListUsers (ListUsersRequest) returns (ListUsersResponse);
  rpc UpdateUser (UpdateUserRequest) returns (UpdateUserResponse);
  rpc DeleteUser (DeleteUserRequest) returns (DeleteUserResponse);
  rpc GetUserEmail (GetUserEmailRequest) returns (GetUserResponse);
  rpc Signin (SigninRequest) returns (SignInResponse);
  rpc Signup (SignupRequest) returns (SignupResponse);
  rpc VerifyOTP (VerifyOTPRequest) returns (VerifyOTPResponse);
  rpc ResendOTP (ResendOTPRequest) returns (ResendOTPResponse);
}

message CreateUserRequest {
  string firstName = 1;
  string lastName = 2;
  string email = 3;
  string password = 4;
  string phone = 5;
}

message SigninRequest {
  string email = 1;
  string password = 2;
}

message SignInResponse {
  bool success = 1;
  GetUserResponse user = 2;
  string error = 3;
  string accessToken = 4;
  string refreshToken = 5;
}

message CreateUserResponse {
  bool success = 1;
  string userId = 2;
}

message GetUserRequest {
  string userId = 1;
}

message GetUserEmailRequest {
  string email = 1;
}

message GetUserResponse {
  string userId = 1;
  string firstName = 2;
  string lastName = 3;
  string email = 4;
  string phone = 5;
  bool isVerified = 6;
  bool isAccountActive = 7;
  google.protobuf.Timestamp lastLoginDate = 8;
  int32 loginAttempts = 9;
  int32 allowedLoginAttempts = 10;
  int32 loginCooldown = 11;
  string createdAt = 12;
  string updatedAt = 13;
}

message ListUsersRequest {
  int32 page = 1;
  int32 limit = 2;
  string search = 3;
}

message ListUsersResponse {
  repeated GetUserResponse users = 1;
  int32 total = 2;
  int32 page = 3;
  int32 limit = 4;
}

message UpdateUserRequest {
  string userId = 1;
  string firstName = 2;
  string lastName = 3;
  string email = 4;
  string phone = 5;
}

message UpdateUserResponse {
  bool success = 1;
}

message DeleteUserRequest {
  string userId = 1;
}

message DeleteUserResponse {
  bool success = 1;
}

// Signup messages
message SignupRequest {
  string firstName = 1;
  string lastName = 2;
  string email = 3;
  string password = 4;
  string appRole = 5;
}

message SignupResponse {
  bool success = 1;
  string userId = 2;
  string message = 3;
  string error = 4;
}

// OTP Verification messages
message VerifyOTPRequest {
  string email = 1;
  string otp = 2;
}

message VerifyOTPResponse {
  bool success = 1;
  string message = 2;
  string error = 3;
}

// Resend OTP messages
message ResendOTPRequest {
  string email = 1;
}

message ResendOTPResponse {
  bool success = 1;
  string message = 2;
  string error = 3;
}
